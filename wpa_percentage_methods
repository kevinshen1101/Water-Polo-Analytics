{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Number of Passes</th>\n",
       "      <th>Passing Sequence</th>\n",
       "      <th>Shooter Number</th>\n",
       "      <th>Shooter Position</th>\n",
       "      <th>Shooter Hand</th>\n",
       "      <th>Rebound</th>\n",
       "      <th>Goal</th>\n",
       "      <th>Block</th>\n",
       "      <th>Skip</th>\n",
       "      <th>Lob</th>\n",
       "      <th>Shot Position</th>\n",
       "      <th>Shot Location</th>\n",
       "      <th>Assisting Player Number</th>\n",
       "      <th>Assisting Player Position</th>\n",
       "      <th>Assisting Player Hand</th>\n",
       "      <th>Rotation Type</th>\n",
       "      <th>Timeout</th>\n",
       "      <th>Team</th>\n",
       "      <th>Turnover</th>\n",
       "      <th>Quarter</th>\n",
       "      <th>Start Time</th>\n",
       "      <th>End Time</th>\n",
       "      <th>Dropped Ball</th>\n",
       "      <th>Kickout Position</th>\n",
       "      <th>Ended Up 3-3</th>\n",
       "      <th>5m</th>\n",
       "      <th>Link to Play</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>7</td>\n",
       "      <td>[6, 4, 1, 4, 1, 6, 4, 1]</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>goalie</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>low</td>\n",
       "      <td>right</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1_pocket, 5_center</td>\n",
       "      <td>0</td>\n",
       "      <td>Szolnoki VSC</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>05:57:00</td>\n",
       "      <td>05:41:00</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=693</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>[6, 4, 6]</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>none</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>low</td>\n",
       "      <td>not_on_cage</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>5_center, 6_pocket</td>\n",
       "      <td>0</td>\n",
       "      <td>Szolnoki VSC</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>05:41:00</td>\n",
       "      <td>05:34:00</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=727</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>5</td>\n",
       "      <td>[5, 1, 6, 4, 6, 4]</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>goalie</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>middle</td>\n",
       "      <td>right</td>\n",
       "      <td>10</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>4_center, 2_pop</td>\n",
       "      <td>1</td>\n",
       "      <td>ZF Eger</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>03:32:00</td>\n",
       "      <td>03:18:00</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=988</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2</td>\n",
       "      <td>[1, 4, 1]</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>goalie</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>middle</td>\n",
       "      <td>center</td>\n",
       "      <td>8</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>none</td>\n",
       "      <td>0</td>\n",
       "      <td>ZF Eger</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>03:15:00</td>\n",
       "      <td>03:07:00</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=1003</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>[4, 6, 4, 1, 6]</td>\n",
       "      <td>10</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>none</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>high</td>\n",
       "      <td>right</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1_in, 6_pocket</td>\n",
       "      <td>0</td>\n",
       "      <td>ZF Eger</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>01:45:00</td>\n",
       "      <td>01:24:00</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=1107</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>[5, 6, 4, 6, 5, 6, 1]</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>none</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>middle</td>\n",
       "      <td>not_on_cage</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>6_in, 1_pocket</td>\n",
       "      <td>0</td>\n",
       "      <td>ZF Eger</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>07:14:00</td>\n",
       "      <td>06:54:00</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=1516</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2</td>\n",
       "      <td>[6, 5, 6]</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>field_player</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>middle</td>\n",
       "      <td>right</td>\n",
       "      <td>10</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>6_pocket</td>\n",
       "      <td>0</td>\n",
       "      <td>ZF Eger</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>06:53:00</td>\n",
       "      <td>06:49:00</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=1540</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>[5, 6, 1, 4, 6, 5, 4, 1, 6]</td>\n",
       "      <td>9</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>goalie</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>low</td>\n",
       "      <td>right</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1_pocket, 4_center</td>\n",
       "      <td>0</td>\n",
       "      <td>Szolnoki VSC</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>06:28:00</td>\n",
       "      <td>06:08:00</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=1650</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>8</td>\n",
       "      <td>[1, 4, 6, 5, 1, 4, 6, 5, 3]</td>\n",
       "      <td>11</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>none</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>low</td>\n",
       "      <td>left</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>6_in, 4_center, 3_pop</td>\n",
       "      <td>0</td>\n",
       "      <td>Szolnoki VSC</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>04:08:00</td>\n",
       "      <td>03:47:00</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=1820</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>8</td>\n",
       "      <td>[6, 4, 5, 4, 1, 4, 6, 5, 6]</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>none</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>not_on_cage</td>\n",
       "      <td>left</td>\n",
       "      <td>10</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1_in, 6_pocket, 5_center</td>\n",
       "      <td>0</td>\n",
       "      <td>Szolnoki VSC</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>02:45:00</td>\n",
       "      <td>02:30:00</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=1969</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>5</td>\n",
       "      <td>[4, 5, 6, 5, 4, 3]</td>\n",
       "      <td>11</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>goalie</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>low</td>\n",
       "      <td>right</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>6_in, 5_center, 3_pop</td>\n",
       "      <td>1</td>\n",
       "      <td>ZF Eger</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>02:11:00</td>\n",
       "      <td>01:54:00</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=2014</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>9</td>\n",
       "      <td>[4, 1, 5, 6, 5, 4, 1, 6, 5, 2]</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>none</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>not_on_cage</td>\n",
       "      <td>center</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>5_center, 3_pop</td>\n",
       "      <td>0</td>\n",
       "      <td>ZF Eger</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>01:22:00</td>\n",
       "      <td>01:04:00</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=2143</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>7</td>\n",
       "      <td>[6, 4, 6, 5, 4, 2, 6, 5]</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>field_player</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>high</td>\n",
       "      <td>right</td>\n",
       "      <td>9</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>6_in, 4_center, 2_pop</td>\n",
       "      <td>0</td>\n",
       "      <td>ZF Eger</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>06:03:00</td>\n",
       "      <td>05:44:00</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=2766</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>7</td>\n",
       "      <td>[5, 4, 6, 5, 4, 1, 4, 3]</td>\n",
       "      <td>11</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>none</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>middle</td>\n",
       "      <td>center</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>4_center, 2_pop</td>\n",
       "      <td>1</td>\n",
       "      <td>ZF Eger</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>04:45:00</td>\n",
       "      <td>04:29:00</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=2925</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>6</td>\n",
       "      <td>[5, 4, 2, 6, 5, 4, 1]</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>none</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>middle</td>\n",
       "      <td>left</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>4_center, 6_in</td>\n",
       "      <td>0</td>\n",
       "      <td>Szolnoki VSC</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>04:20:00</td>\n",
       "      <td>04:04:00</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=3345</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>7</td>\n",
       "      <td>[4, 6, 5, 1, 6, 5, 4, 6]</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>none</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>low</td>\n",
       "      <td>right</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1_pocket, 4_center, 6_pocket</td>\n",
       "      <td>0</td>\n",
       "      <td>ZF Eger</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>01:11:00</td>\n",
       "      <td>00:53:00</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=3345</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>9</td>\n",
       "      <td>[6, 4, 1, 4, 2, 5, 4, 6, 4, 2]</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>none</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>low</td>\n",
       "      <td>right</td>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1_pocket, 4_center, 2_pop</td>\n",
       "      <td>0</td>\n",
       "      <td>Szolnoki VSC</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>00:42:00</td>\n",
       "      <td>00:21:00</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=3423</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>6</td>\n",
       "      <td>[4, 1, 6, 5, 6, 4, 6]</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>goalie</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>high</td>\n",
       "      <td>left</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>6_pocket, 5_center</td>\n",
       "      <td>0</td>\n",
       "      <td>Szolnoki VSC</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>06:51:00</td>\n",
       "      <td>06:32:00</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=3755</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>2</td>\n",
       "      <td>[6, 5, 6]</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>goalie</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>low</td>\n",
       "      <td>left</td>\n",
       "      <td>10</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>none</td>\n",
       "      <td>0</td>\n",
       "      <td>ZF Eger</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>06:14:00</td>\n",
       "      <td>06:05:00</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=3822</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>5</td>\n",
       "      <td>[1, 4, 6, 4, 1, 6]</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>none</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>low</td>\n",
       "      <td>right</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1_pocket</td>\n",
       "      <td>0</td>\n",
       "      <td>ZF Eger</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>06:05:00</td>\n",
       "      <td>05:52:00</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=3845</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>8</td>\n",
       "      <td>[5, 6, 5, 4, 1, 6, 5, 4, 1]</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>none</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>high</td>\n",
       "      <td>middle</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>6_in, 4_center</td>\n",
       "      <td>0</td>\n",
       "      <td>Szolnoki VSC</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>04:12:00</td>\n",
       "      <td>03:50:00</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=4065</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>5</td>\n",
       "      <td>[5, 6, 4, 6, 1, 3]</td>\n",
       "      <td>14</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>none</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>none</td>\n",
       "      <td>none</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4_center, 6_pocket, 1_in</td>\n",
       "      <td>0</td>\n",
       "      <td>Szolnoki VSC</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>03:13:00</td>\n",
       "      <td>02:47:00</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=4165</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>9</td>\n",
       "      <td>[4, 6, 5, 1, 4, 6, 5, 4, 1, 6]</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>none</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>low</td>\n",
       "      <td>right</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>6_in, 4_center, 1_pocket</td>\n",
       "      <td>0</td>\n",
       "      <td>Szolnoki VSC</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>01:58:00</td>\n",
       "      <td>01:32:00</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>https://youtu.be/162be27-zQA?t=4375</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Number of Passes                Passing Sequence  Shooter Number  \\\n",
       "0                  7        [6, 4, 1, 4, 1, 6, 4, 1]               3   \n",
       "1                  2                       [6, 4, 6]               4   \n",
       "2                  5              [5, 1, 6, 4, 6, 4]               5   \n",
       "3                  2                       [1, 4, 1]               3   \n",
       "4                  4                 [4, 6, 4, 1, 6]              10   \n",
       "5                  6           [5, 6, 4, 6, 5, 6, 1]               6   \n",
       "6                  2                       [6, 5, 6]               4   \n",
       "7                  8     [5, 6, 1, 4, 6, 5, 4, 1, 6]               9   \n",
       "8                  8     [1, 4, 6, 5, 1, 4, 6, 5, 3]              11   \n",
       "9                  8     [6, 4, 5, 4, 1, 4, 6, 5, 6]               4   \n",
       "10                 5              [4, 5, 6, 5, 4, 3]              11   \n",
       "11                 9  [4, 1, 5, 6, 5, 4, 1, 6, 5, 2]               2   \n",
       "12                 7        [6, 4, 6, 5, 4, 2, 6, 5]               5   \n",
       "13                 7        [5, 4, 6, 5, 4, 1, 4, 3]              11   \n",
       "14                 6           [5, 4, 2, 6, 5, 4, 1]              10   \n",
       "15                 7        [4, 6, 5, 1, 6, 5, 4, 6]               4   \n",
       "16                 9  [6, 4, 1, 4, 2, 5, 4, 6, 4, 2]               8   \n",
       "17                 6           [4, 1, 6, 5, 6, 4, 6]               4   \n",
       "18                 2                       [6, 5, 6]               4   \n",
       "19                 5              [1, 4, 6, 4, 1, 6]               4   \n",
       "20                 8     [5, 6, 5, 4, 1, 6, 5, 4, 1]              10   \n",
       "21                 5              [5, 6, 4, 6, 1, 3]              14   \n",
       "22                 9  [4, 6, 5, 1, 4, 6, 5, 4, 1, 6]               4   \n",
       "\n",
       "    Shooter Position  Shooter Hand  Rebound  Goal         Block  Skip  Lob  \\\n",
       "0                  1             1        0     0        goalie     1    0   \n",
       "1                  6             0        1     0          none     1    0   \n",
       "2                  4             1        0     0        goalie     0    0   \n",
       "3                  1             1        1     0        goalie     1    0   \n",
       "4                  6             1        0     1          none     0    0   \n",
       "5                  1             1        0     0          none     1    0   \n",
       "6                  6             1        1     0  field_player     0    0   \n",
       "7                  6             1        0     0        goalie     1    0   \n",
       "8                  3             1        0     1          none     0    0   \n",
       "9                  6             0        0     0          none     0    0   \n",
       "10                 3             1        0     0        goalie     1    0   \n",
       "11                 2             1        0     0          none     0    0   \n",
       "12                 5             1        0     0  field_player     0    0   \n",
       "13                 3             1        0     1          none     0    0   \n",
       "14                 1             1        0     1          none     0    0   \n",
       "15                 6             1        0     1          none     1    0   \n",
       "16                 2             1        0     1          none     1    0   \n",
       "17                 6             0        0     0        goalie     0    0   \n",
       "18                 6             1        0     0        goalie     1    0   \n",
       "19                 6             1        1     1          none     1    0   \n",
       "20                 1             1        0     1          none     0    0   \n",
       "21                 3             1        0     0          none     0    0   \n",
       "22                 6             0        0     1          none     1    0   \n",
       "\n",
       "   Shot Position Shot Location  Assisting Player Number  \\\n",
       "0            low         right                        8   \n",
       "1            low   not_on_cage                        8   \n",
       "2         middle         right                       10   \n",
       "3         middle        center                        8   \n",
       "4           high         right                        3   \n",
       "5         middle   not_on_cage                        4   \n",
       "6         middle         right                       10   \n",
       "7            low         right                        3   \n",
       "8            low          left                        2   \n",
       "9    not_on_cage          left                       10   \n",
       "10           low         right                        8   \n",
       "11   not_on_cage        center                        5   \n",
       "12          high         right                        9   \n",
       "13        middle        center                        3   \n",
       "14        middle          left                        8   \n",
       "15           low         right                        5   \n",
       "16           low         right                        7   \n",
       "17          high          left                        2   \n",
       "18           low          left                       10   \n",
       "19           low         right                        5   \n",
       "20          high        middle                        8   \n",
       "21          none          none                        2   \n",
       "22           low         right                        7   \n",
       "\n",
       "    Assisting Player Position  Assisting Player Hand  \\\n",
       "0                           4                      1   \n",
       "1                           4                      1   \n",
       "2                           6                      1   \n",
       "3                           5                      1   \n",
       "4                           1                      1   \n",
       "5                           6                      1   \n",
       "6                           4                      1   \n",
       "7                           1                      1   \n",
       "8                           5                      1   \n",
       "9                           5                      1   \n",
       "10                          4                      1   \n",
       "11                          5                      1   \n",
       "12                          6                      1   \n",
       "13                          4                      1   \n",
       "14                          4                      1   \n",
       "15                          4                      1   \n",
       "16                          4                      1   \n",
       "17                          5                      1   \n",
       "18                          5                      1   \n",
       "19                          1                      1   \n",
       "20                          4                      1   \n",
       "21                          1                      1   \n",
       "22                          1                      1   \n",
       "\n",
       "                   Rotation Type  Timeout          Team  Turnover  Quarter  \\\n",
       "0             1_pocket, 5_center        0  Szolnoki VSC         0        1   \n",
       "1             5_center, 6_pocket        0  Szolnoki VSC         0        1   \n",
       "2                4_center, 2_pop        1       ZF Eger         0        1   \n",
       "3                           none        0       ZF Eger         0        1   \n",
       "4                 1_in, 6_pocket        0       ZF Eger         0        1   \n",
       "5                 6_in, 1_pocket        0       ZF Eger         0        2   \n",
       "6                       6_pocket        0       ZF Eger         0        2   \n",
       "7             1_pocket, 4_center        0  Szolnoki VSC         0        2   \n",
       "8          6_in, 4_center, 3_pop        0  Szolnoki VSC         0        2   \n",
       "9       1_in, 6_pocket, 5_center        0  Szolnoki VSC         0        2   \n",
       "10         6_in, 5_center, 3_pop        1       ZF Eger         0        2   \n",
       "11               5_center, 3_pop        0       ZF Eger         0        2   \n",
       "12         6_in, 4_center, 2_pop        0       ZF Eger         0        3   \n",
       "13               4_center, 2_pop        1       ZF Eger         0        3   \n",
       "14                4_center, 6_in        0  Szolnoki VSC         0        3   \n",
       "15  1_pocket, 4_center, 6_pocket        0       ZF Eger         0        3   \n",
       "16     1_pocket, 4_center, 2_pop        0  Szolnoki VSC         0        3   \n",
       "17            6_pocket, 5_center        0  Szolnoki VSC         0        4   \n",
       "18                          none        0       ZF Eger         0        4   \n",
       "19                      1_pocket        0       ZF Eger         0        4   \n",
       "20                6_in, 4_center        0  Szolnoki VSC         0        4   \n",
       "21      4_center, 6_pocket, 1_in        0  Szolnoki VSC         1        4   \n",
       "22      6_in, 4_center, 1_pocket        0  Szolnoki VSC         0        4   \n",
       "\n",
       "   Start Time  End Time  Dropped Ball  Kickout Position  Ended Up 3-3  5m  \\\n",
       "0    05:57:00  05:41:00             0                 0             0   0   \n",
       "1    05:41:00  05:34:00             0                 0             0   0   \n",
       "2    03:32:00  03:18:00             0                 0             0   0   \n",
       "3    03:15:00  03:07:00             1                 0             0   0   \n",
       "4    01:45:00  01:24:00             3                 1             0   0   \n",
       "5    07:14:00  06:54:00             2                 0             0   0   \n",
       "6    06:53:00  06:49:00             1                 0             0   0   \n",
       "7    06:28:00  06:08:00             0                 0             0   0   \n",
       "8    04:08:00  03:47:00             1                 1             1   0   \n",
       "9    02:45:00  02:30:00             0                 0             1   0   \n",
       "10   02:11:00  01:54:00             1                 0             0   0   \n",
       "11   01:22:00  01:04:00             3                 0             0   0   \n",
       "12   06:03:00  05:44:00             0                 0             0   0   \n",
       "13   04:45:00  04:29:00             1                 0             0   0   \n",
       "14   04:20:00  04:04:00             1                 0             0   0   \n",
       "15   01:11:00  00:53:00             2                 0             0   0   \n",
       "16   00:42:00  00:21:00             1                 0             0   0   \n",
       "17   06:51:00  06:32:00             0                 0             0   0   \n",
       "18   06:14:00  06:05:00             1                 1             0   0   \n",
       "19   06:05:00  05:52:00             1                 0             0   0   \n",
       "20   04:12:00  03:50:00             3                 1             0   0   \n",
       "21   03:13:00  02:47:00             2                 1             0   0   \n",
       "22   01:58:00  01:32:00             2                 1             0   0   \n",
       "\n",
       "                           Link to Play  \n",
       "0    https://youtu.be/162be27-zQA?t=693  \n",
       "1    https://youtu.be/162be27-zQA?t=727  \n",
       "2    https://youtu.be/162be27-zQA?t=988  \n",
       "3   https://youtu.be/162be27-zQA?t=1003  \n",
       "4   https://youtu.be/162be27-zQA?t=1107  \n",
       "5   https://youtu.be/162be27-zQA?t=1516  \n",
       "6   https://youtu.be/162be27-zQA?t=1540  \n",
       "7   https://youtu.be/162be27-zQA?t=1650  \n",
       "8   https://youtu.be/162be27-zQA?t=1820  \n",
       "9   https://youtu.be/162be27-zQA?t=1969  \n",
       "10  https://youtu.be/162be27-zQA?t=2014  \n",
       "11  https://youtu.be/162be27-zQA?t=2143  \n",
       "12  https://youtu.be/162be27-zQA?t=2766  \n",
       "13  https://youtu.be/162be27-zQA?t=2925  \n",
       "14  https://youtu.be/162be27-zQA?t=3345  \n",
       "15  https://youtu.be/162be27-zQA?t=3345  \n",
       "16  https://youtu.be/162be27-zQA?t=3423  \n",
       "17  https://youtu.be/162be27-zQA?t=3755  \n",
       "18  https://youtu.be/162be27-zQA?t=3822  \n",
       "19  https://youtu.be/162be27-zQA?t=3845  \n",
       "20  https://youtu.be/162be27-zQA?t=4065  \n",
       "21  https://youtu.be/162be27-zQA?t=4165  \n",
       "22  https://youtu.be/162be27-zQA?t=4375  "
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.set_option('display.max_columns', 500)\n",
    "\n",
    "eger_szolnoki = pd.read_excel(\"game_data/ZF_Eger-Szolnoki_VSC.xlsx\")\n",
    "df = eger_szolnoki\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": [
    "# pass in assist_pos if we want to see data with assist pair\n",
    "# pass in nothing for assist_pos to only get data on the shooting_pos (independent of assisting player position)\n",
    "def positions_shots(df, shooter_pos, assist_pos=None):\n",
    "    if assist_pos is None:\n",
    "        filter_df = df[df['Shooter Position'] == shooter_pos]\n",
    "        return shot_breakdown(filter_df)\n",
    "    filter_df = df[(df['Shooter Position'] == shooter_pos) & (df[\"Assisting Player Position\"] == assist_pos)]\n",
    "    return shot_breakdown(filter_df)\n",
    "\n",
    "# output: {(shot position, shot location):(goals, attempts, percentage)}\n",
    "def shot_breakdown(df):\n",
    "    shot_df = df.groupby([\"Shot Position\", \"Shot Location\"]).agg({\"Goal\": \"sum\", \"Timeout\": \"count\"}).reset_index().rename(columns={'Timeout':'Attempts'})\n",
    "    shot_df[\"Goal_Percentage\"] = shot_df[\"Goal\"]/shot_df[\"Attempts\"] * 100\n",
    "    shot_dict = dict()\n",
    "    for _, row in shot_df.iterrows():\n",
    "        shot_key = (row[\"Shot Position\"], row[\"Shot Location\"])\n",
    "        shot_value = (row[\"Goal\"], row[\"Attempts\"], row[\"Goal_Percentage\"])\n",
    "        shot_dict[shot_key] = shot_value\n",
    "    return shot_dict   "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "#Goals\n",
    "goals = df.groupby(['Shooter Position']).sum()['Goal']\n",
    "#Attempts\n",
    "attempts = df['Shooter Position'].value_counts()\n",
    "positions_df = pd.concat([goals, attempts], axis=1)\n",
    "positions_df.rename(columns={'Shooter Position':'Attempts'}, inplace=True)\n",
    "positions_df['Percentage'] = positions_df['Goal'] / positions_df['Attempts']"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Getting the highest scoring/percentage positions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# position with the most goals\n",
    "positions_df['Goal'].idxmax()\n",
    "# position with the highest percentage\n",
    "positions_df['Percentage'].idxmax()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [],
   "source": [
    "def shooting_positions(df):\n",
    "    #Goals\n",
    "    goals = df.groupby(['Shooter Position']).sum()['Goal']\n",
    "    #Attempts\n",
    "    attempts = df['Shooter Position'].value_counts()\n",
    "    positions_df = pd.concat([goals, attempts], axis=1)\n",
    "    positions_df.rename(columns={'Shooter Position':'Attempts'}, inplace=True)\n",
    "    positions_df['Percentage'] = positions_df['Goal'] / positions_df['Attempts']\n",
    "    return positions_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Goal</th>\n",
       "      <th>Attempts</th>\n",
       "      <th>Percentage</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>0.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>0.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>4</td>\n",
       "      <td>10</td>\n",
       "      <td>0.4</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Goal  Attempts  Percentage\n",
       "1     2         5         0.4\n",
       "2     1         2         0.5\n",
       "3     2         4         0.5\n",
       "4     0         1         0.0\n",
       "5     0         1         0.0\n",
       "6     4        10         0.4"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "shooting_positions(df)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Run the .idxmax() to get the most successful positions &&&\n",
    "Run position_shots() from 1-6 to get the shot break down"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Dropped ball analysis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [],
   "source": [
    "def dropped_ball(df):\n",
    "    goals = df.groupby(['Dropped Ball']).sum()['Goal']\n",
    "    attempts = df['Dropped Ball'].value_counts()\n",
    "    dropped_df = pd.concat([goals, attempts], axis=1)\n",
    "    dropped_df.rename(columns={'Dropped Ball':'Attempts'}, inplace=True)\n",
    "    dropped_df['Percentage'] = dropped_df['Goal'] / dropped_df['Attempts']\n",
    "    return dropped_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Goal</th>\n",
       "      <th>Attempts</th>\n",
       "      <th>Percentage</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>5</td>\n",
       "      <td>9</td>\n",
       "      <td>0.555556</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>0.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>0.666667</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Goal  Attempts  Percentage\n",
       "0     0         7    0.000000\n",
       "1     5         9    0.555556\n",
       "2     2         4    0.500000\n",
       "3     2         3    0.666667"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dropped_ball(df)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Time out analysis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    20\n",
       "1     3\n",
       "Name: Timeout, dtype: int64"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['Timeout'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [],
   "source": [
    "def timeout(df):\n",
    "    goals = df.groupby(['Timeout']).sum()['Goal']\n",
    "    attempts = df['Timeout'].value_counts()\n",
    "    timeout_df = pd.concat([goals, attempts], axis=1)\n",
    "    timeout_df.rename(columns={'Timeout':'Attempts'}, inplace=True)\n",
    "    timeout_df['Percentage'] = timeout_df['Goal'] / timeout_df['Attempts']\n",
    "    timeout_df.rename(index = {0: \"No Timeout\", \n",
    "                     1:\"Timeout\"}, inplace = True) \n",
    "    return timeout_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Goal</th>\n",
       "      <th>Attempts</th>\n",
       "      <th>Percentage</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Timeout</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>No Timeout</th>\n",
       "      <td>8</td>\n",
       "      <td>20</td>\n",
       "      <td>0.400000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Timeout</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0.333333</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            Goal  Attempts  Percentage\n",
       "Timeout                               \n",
       "No Timeout     8        20    0.400000\n",
       "Timeout        1         3    0.333333"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "timeout(df)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Ejection position analysis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [],
   "source": [
    "def ejection_position(df):\n",
    "    goals = df.groupby(['Kickout Position']).sum()['Goal']\n",
    "    attempts = df['Kickout Position'].value_counts()\n",
    "    ejection_df = pd.concat([goals, attempts], axis=1)\n",
    "    ejection_df.rename(columns={'Kickout Position':'Attempts'}, inplace=True)\n",
    "    ejection_df['Percentage'] = ejection_df['Goal'] / ejection_df['Attempts']\n",
    "    ejection_df.rename(index = {0: \"Frontcourt\", \n",
    "                     1:\"Backcourt\"}, inplace = True) \n",
    "    return ejection_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Goal</th>\n",
       "      <th>Attempts</th>\n",
       "      <th>Percentage</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Kickout Position</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Frontcourt</th>\n",
       "      <td>5</td>\n",
       "      <td>17</td>\n",
       "      <td>0.294118</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Backcourt</th>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>0.666667</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                  Goal  Attempts  Percentage\n",
       "Kickout Position                            \n",
       "Frontcourt           5        17    0.294118\n",
       "Backcourt            4         6    0.666667"
      ]
     },
     "execution_count": 65,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ejection_position(df)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3-3 analysis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [],
   "source": [
    "def three_three(df):\n",
    "    goals = df.groupby(['Ended Up 3-3']).sum()['Goal']\n",
    "    attempts = df['Ended Up 3-3'].value_counts()\n",
    "    three_three_df = pd.concat([goals, attempts], axis=1)\n",
    "    three_three_df.rename(columns={'Ended Up 3-3':'Attempts'}, inplace=True)\n",
    "    three_three_df['Percentage'] = three_three_df['Goal'] / three_three_df['Attempts']\n",
    "    three_three_df.rename(index = {0: \"4-2\", \n",
    "                     1:\"3-3\"}, inplace = True) \n",
    "    return three_three_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Goal</th>\n",
       "      <th>Attempts</th>\n",
       "      <th>Percentage</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ended Up 3-3</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4-2</th>\n",
       "      <td>8</td>\n",
       "      <td>21</td>\n",
       "      <td>0.380952</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3-3</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0.500000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              Goal  Attempts  Percentage\n",
       "Ended Up 3-3                            \n",
       "4-2              8        21    0.380952\n",
       "3-3              1         2    0.500000"
      ]
     },
     "execution_count": 67,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "three_three(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "wpanalytics",
   "language": "python",
   "name": "wpanalytics"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
